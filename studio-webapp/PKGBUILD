# Maintainer: Sebastian Reimers <hallo@studio-link.de>
pkgname=studio-webapp
pkgver=15.1.0
pkgrel=4
arch=(armv7h x86_64)
license=('BSD license')
suffix="master"
#source=("https://github.com/Studio-Link/webapp/archive/$pkgver-beta.tar.gz")
source=("https://github.com/Studio-Link/webapp/archive/$suffix.tar.gz")
md5sums=('SKIP')

build() {
    cd webapp-$suffix/long_polling
    make
}

package() {
    mkdir -p "${pkgdir}/opt/studio"
    virtualenv2 --system-site-packages "${pkgdir}/opt/studio"
    cp -a ${srcdir}/webapp-$suffix ${pkgdir}/opt/studio/webapp
    ${pkgdir}/opt/studio/bin/pip install pytz==2014.10 
    ${pkgdir}/opt/studio/bin/pip install --upgrade -r ${pkgdir}/opt/studio/webapp/requirements.txt
    virtualenv2 --relocatable "${pkgdir}/opt/studio"
    chown -R 1000:1000 ${pkgdir}/opt/studio
}
